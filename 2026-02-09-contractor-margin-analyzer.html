<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rover Contractor Margin Analyzer</title>
<style>
:root { --bg: #0f1117; --card: #1a1d27; --border: #2a2d3a; --accent: #6366f1; --accent2: #818cf8; --green: #22c55e; --yellow: #eab308; --red: #ef4444; --text: #e2e8f0; --muted: #94a3b8; }
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); min-height: 100vh; padding: 24px; }
h1 { font-size: 1.5rem; margin-bottom: 4px; }
.subtitle { color: var(--muted); font-size: 0.85rem; margin-bottom: 24px; }
.grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; max-width: 1100px; margin: 0 auto; }
@media (max-width: 700px) { .grid { grid-template-columns: 1fr; } }
.card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 20px; }
.card h2 { font-size: 1rem; margin-bottom: 16px; color: var(--accent2); }
label { display: block; font-size: 0.8rem; color: var(--muted); margin-bottom: 4px; margin-top: 12px; }
label:first-of-type { margin-top: 0; }
input, select { width: 100%; padding: 8px 12px; background: var(--bg); border: 1px solid var(--border); border-radius: 8px; color: var(--text); font-size: 0.95rem; }
input:focus, select:focus { outline: none; border-color: var(--accent); }
.row { display: flex; gap: 12px; }
.row > div { flex: 1; }
.result-card { grid-column: 1 / -1; }
.metrics { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 16px; margin-top: 16px; }
.metric { text-align: center; padding: 16px; background: var(--bg); border-radius: 10px; }
.metric .value { font-size: 1.8rem; font-weight: 700; }
.metric .label { font-size: 0.75rem; color: var(--muted); margin-top: 4px; }
.green { color: var(--green); }
.yellow { color: var(--yellow); }
.red { color: var(--red); }
.bar-container { margin-top: 20px; }
.bar-row { display: flex; align-items: center; margin-bottom: 8px; }
.bar-label { width: 100px; font-size: 0.8rem; color: var(--muted); text-align: right; padding-right: 12px; }
.bar-track { flex: 1; height: 24px; background: var(--bg); border-radius: 6px; overflow: hidden; position: relative; }
.bar-fill { height: 100%; border-radius: 6px; transition: width 0.4s ease; }
.bar-value { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); font-size: 0.75rem; font-weight: 600; }
.scenarios { margin-top: 20px; }
.scenarios table { width: 100%; border-collapse: collapse; font-size: 0.85rem; }
.scenarios th { text-align: left; color: var(--muted); font-weight: 500; padding: 8px; border-bottom: 1px solid var(--border); }
.scenarios td { padding: 8px; border-bottom: 1px solid var(--border); }
.scenarios tr:last-child td { border: none; }
.tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 600; }
.tag-good { background: rgba(34,197,94,0.15); color: var(--green); }
.tag-ok { background: rgba(234,179,8,0.15); color: var(--yellow); }
.tag-bad { background: rgba(239,68,68,0.15); color: var(--red); }
.header { max-width: 1100px; margin: 0 auto 24px; }
.note { font-size: 0.75rem; color: var(--muted); margin-top: 16px; font-style: italic; }
</style>
</head>
<body>
<div class="header">
<h1>üßπ Rover Contractor Margin Analyzer</h1>
<p class="subtitle">Model job profitability before you quote ‚Äî plug in numbers, see your margin instantly</p>
</div>
<div class="grid">
<div class="card">
<h2>üìã Job Details</h2>
<div class="row">
<div>
<label>Bedrooms</label>
<input type="number" id="beds" value="3" min="1" max="10" oninput="calc()">
</div>
<div>
<label>Bathrooms</label>
<input type="number" id="baths" value="2" min="1" max="10" oninput="calc()">
</div>
<div>
<label>Sq Ft</label>
<input type="number" id="sqft" value="1500" step="100" oninput="calc()">
</div>
</div>
<label>Job Type</label>
<select id="jobType" onchange="calc()">
<option value="DC">Deep Clean (DC)</option>
<option value="SC">Standard Clean (SC)</option>
<option value="MC">Move-out Clean (MC)</option>
<option value="WRC">Weekly Recurring (WRC)</option>
<option value="BRC" selected>Biweekly Recurring (BRC)</option>
<option value="3RC">Every 3 Weeks (3RC)</option>
<option value="MRC">Monthly Recurring (MRC)</option>
<option value="6RC">Every 6 Weeks (6RC)</option>
</select>
<label>Market</label>
<select id="market" onchange="calc()">
<option value="DFW" selected>DFW</option>
<option value="Chicago">Chicago</option>
<option value="Gainesville">Gainesville</option>
</select>
</div>
<div class="card">
<h2>üí∞ Financials</h2>
<label>Quote to Customer ($)</label>
<input type="number" id="revenue" value="200" step="5" oninput="calc()">
<label>Contractor Pay ($)</label>
<input type="number" id="pay" value="90" step="5" oninput="calc()">
<label>Drive Time Pay ($)</label>
<input type="number" id="drive" value="10" step="5" oninput="calc()">
<label>Est. Hours on Site</label>
<input type="number" id="hours" value="3" step="0.5" oninput="calc()">
<label># Contractors on Job</label>
<input type="number" id="crew" value="2" min="1" max="5" oninput="calc()">
</div>
<div class="card result-card" id="results">
</div>
<div class="card result-card">
<h2>üìä What-If: Adjusting the Quote</h2>
<div class="scenarios" id="scenarios"></div>
</div>
<div class="card result-card">
<h2>üîÅ Recurring Revenue Projection</h2>
<p class="subtitle" style="margin-bottom:12px">If this becomes a recurring client at this margin</p>
<div class="metrics" id="recurring"></div>
<p class="note" id="recurNote"></p>
</div>
</div>
<script>
const freqMap = { WRC: 52, BRC: 26, '3RC': 17, MRC: 12, '6RC': 8, DC: 1, SC: 1, MC: 1 };
const freqLabel = { WRC: 'Weekly', BRC: 'Biweekly', '3RC': 'Every 3wk', MRC: 'Monthly', '6RC': 'Every 6wk', DC: 'One-time', SC: 'One-time', MC: 'One-time' };

function marginColor(m) { return m >= 45 ? 'green' : m >= 35 ? 'yellow' : 'red'; }
function tagClass(m) { return m >= 45 ? 'tag-good' : m >= 35 ? 'tag-ok' : 'tag-bad'; }
function fmt(n) { return '$' + n.toFixed(0); }

function calc() {
  const rev = +document.getElementById('revenue').value || 0;
  const pay = +document.getElementById('pay').value || 0;
  const drive = +document.getElementById('drive').value || 0;
  const hours = +document.getElementById('hours').value || 1;
  const crew = +document.getElementById('crew').value || 1;
  const jt = document.getElementById('jobType').value;

  const totalCost = pay + drive;
  const gp = rev - totalCost;
  const margin = rev > 0 ? (gp / rev) * 100 : 0;
  const effRate = hours > 0 ? rev / hours : 0;
  const payPerHr = hours > 0 ? pay / (hours * crew) : 0;

  const mc = marginColor(margin);
  document.getElementById('results').innerHTML = `
    <h2>üìà Job Analysis</h2>
    <div class="metrics">
      <div class="metric"><div class="value ${mc}">${fmt(gp)}</div><div class="label">Gross Profit</div></div>
      <div class="metric"><div class="value ${mc}">${margin.toFixed(1)}%</div><div class="label">Margin</div></div>
      <div class="metric"><div class="value">${fmt(effRate)}</div><div class="label">Revenue / Hr</div></div>
      <div class="metric"><div class="value">${fmt(payPerHr)}</div><div class="label">Contractor $/Hr</div></div>
    </div>
    <div class="bar-container">
      <div class="bar-row">
        <div class="bar-label">Revenue</div>
        <div class="bar-track"><div class="bar-fill" style="width:100%;background:var(--accent)"></div><div class="bar-value">${fmt(rev)}</div></div>
      </div>
      <div class="bar-row">
        <div class="bar-label">Ctr Pay</div>
        <div class="bar-track"><div class="bar-fill" style="width:${rev>0?pay/rev*100:0}%;background:var(--red)"></div><div class="bar-value">${fmt(pay)}</div></div>
      </div>
      <div class="bar-row">
        <div class="bar-label">Drive Pay</div>
        <div class="bar-track"><div class="bar-fill" style="width:${rev>0?drive/rev*100:0}%;background:var(--yellow)"></div><div class="bar-value">${fmt(drive)}</div></div>
      </div>
      <div class="bar-row">
        <div class="bar-label">Profit</div>
        <div class="bar-track"><div class="bar-fill" style="width:${rev>0?gp/rev*100:0}%;background:var(--green)"></div><div class="bar-value">${fmt(gp)}</div></div>
      </div>
    </div>
    <p class="note">${margin >= 45 ? '‚úÖ Healthy margin ‚Äî this job prints money' : margin >= 35 ? '‚ö†Ô∏è Acceptable but thin ‚Äî consider bumping the quote $10-20' : 'üö® Below target ‚Äî raise the quote or cut costs'}</p>
  `;

  // What-if scenarios
  let rows = '';
  for (let delta = -30; delta <= 40; delta += 10) {
    const newRev = rev + delta;
    const newGP = newRev - totalCost;
    const newM = newRev > 0 ? (newGP / newRev) * 100 : 0;
    const current = delta === 0 ? ' style="font-weight:700"' : '';
    rows += `<tr${current}><td>${fmt(newRev)}${delta===0?' (current)':''}</td><td>${fmt(newGP)}</td><td>${newM.toFixed(1)}% <span class="tag ${tagClass(newM)}">${newM>=45?'Good':newM>=35?'OK':'Low'}</span></td></tr>`;
  }
  document.getElementById('scenarios').innerHTML = `<table><thead><tr><th>Quote</th><th>GP</th><th>Margin</th></tr></thead><tbody>${rows}</tbody></table>`;

  // Recurring projection
  const freq = freqMap[jt];
  const isRecur = freq > 1;
  const annualRev = rev * freq;
  const annualGP = gp * freq;
  const monthlyGP = annualGP / 12;
  document.getElementById('recurring').innerHTML = isRecur ? `
    <div class="metric"><div class="value">${freqLabel[jt]}</div><div class="label">Frequency</div></div>
    <div class="metric"><div class="value">${freq}x</div><div class="label">Jobs / Year</div></div>
    <div class="metric"><div class="value">${fmt(annualRev)}</div><div class="label">Annual Revenue</div></div>
    <div class="metric"><div class="value green">${fmt(annualGP)}</div><div class="label">Annual GP</div></div>
    <div class="metric"><div class="value green">${fmt(monthlyGP)}</div><div class="label">Monthly GP</div></div>
  ` : `<div class="metric"><div class="value">‚Äî</div><div class="label">One-time job, no recurring</div></div>`;
  document.getElementById('recurNote').textContent = isRecur
    ? `This single client generates ${fmt(annualRev)}/yr revenue. You need ~${Math.ceil(100000/( rev * freq / 12 ))} clients like this to hit $100K/mo.`
    : '';
}

calc();
</script>
</body>
</html>
